<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layouts/defaultLayout}"
      layout:fragment="Content">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<!-- chat.html 필수 axios -->
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<!-- Google Tag Manager -->
<!-- End Google Tag Manager -->
<!-- External CSS libraries -->
<!-- Favicon icon -->
<!-- Google fonts -->
<!-- Custom Stylesheet -->


<style>
/* 채팅창 전체 스타일 */
.chatbox {
  background-color: #f7f7f7;
  border: 1px solid #ccc;
  border-radius: 5px;
  padding: 10px;
  height: 400px;
  overflow-y: scroll;
}

/* 사용자 입력창 스타일 */
#message {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 5px;
  margin-bottom: 10px;
}

/* 채팅내용 스타일 */
.chat-message {
  margin-bottom: 10px;
}

/* 사용자 메시지 스타일 */
.user-message {
  text-align: right;
  color: #007bff;
}

/* 봇 메시지 스타일 */
.bot-message {
  text-align: left;
  color: #28a745;
}
</style>

</head>
<body id="top">

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PDTWJ3Z"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div class="page_loader"></div>

<!-- main header start -->
	<!-- common/header.html -->
<!-- main header end -->

<!-- Sub banner start -->
<div class="sub-banner">
    <div class="container">
        <div class="breadcrumb-area">
            <h1>실시간 상담</h1>
        </div>
    </div>
</div>
<!-- Sub banner end -->


<!-- Destination start -->
<div class="destination d-2 content-area-2">
    <div class="container">

	    <div style="font-size:50px">무엇이든 물어보세요</div><br>
	    <br><hr><br>
	    
	    <div id="chatbox" style="background-color: #f5f5f5; color: black; font-family: Arial, sans-serif; width: 400px; height: 500px; padding: 10px; border: 1px solid black; overflow-y: scroll;"></div>
  	 	<textarea id="message" name="message" style="width: 400px; margin-top: 10px;"></textarea><br>
    	<button onclick="sendMessage()" style="margin-top: 10px;">전송</button>
	    
 </div>
</div>
<!-- Destination end -->

  <script>
    var chatbox = document.getElementById("chatbox");

    function sendMessage() {
      var message = document.getElementById("message").value;
      axios.post('http://localhost:80/send', {}, {
        params: {
          message: message
        }
      })
      .then(function (response) {
        var text = response.data.choices[0].text;
        chatbox.innerHTML += "<div style='background-color: #dbf5b4; margin-bottom: 5px; padding: 5px;'><strong>User:</strong> " + message + "</div>";
        chatbox.innerHTML += "<div style='background-color: #f7f7f7; margin-bottom: 5px; padding: 5px;'><strong>떠나고 요정:</strong> " + text + "</div>";
        chatbox.scrollTop = chatbox.scrollHeight;
        document.getElementById("message").value = "";
      })
      .catch(function (error) {
        console.log(error);
      });
    }
  </script>
  
<!-- Footer-6 start -->
<!-- Footer-6 end -->

<!-- profile.html 필요 JS 라이브러리 -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

<!-- External JS libraries -->
<!-- Custom JS Script -->

</body>
</html>